PROYECTO INDEX

<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <!-- CSS only -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
</head>

<body>

  <div class="container mt-5">

    <div class="row d-flex justify-content-center mb-3">

      <div class="col-3">
        <select class="form-select" id="nombreSocio" name="nombre_socio" aria-label="Default select example"
             required>
            <option selected none>Seleccione socio</option>
            <option value="PERENCO">PERENCO</option>
            <option value="ONG">ONG</option>
            <option value="PETRODORADO">PETRODORADO</option>
            <option value="TALISMAN">TALISMAN</option>
            <option value="CEPSA">CEPSA</option>
            <option value="GREEN POWER">GREEN POWER</option>
            <option value="MARAL">MARAL</option>
            <option value="GEOPARK">GEOPARK</option>
            <option value="BRICCON">BRICCON</option>
            <option value="HOCOL">HOCOL</option>
            <option value="PETROBRAS">PETROBRAS</option>
            <option value="PETROSUD">PETROSUD</option>
            <option value="PAREX">PAREX</option>
          </select>
      </div>
      <div class="col-3">
        <button type="button" class="btn btn-primary"
        onclick="buscarRegistro()">Buscar</button>
      </div>
    </div>
    <div class="row d-flex justify-content-evenly mb-3">
      <div class="col-3">
        <input type="text" class="form-control" id="numeroSocio"
        placeholder="No.Socio" aria-label="First-name"readonly>
      </div>
      <div class="col-3">
        <input type="text" class="form-control" id="Socio"
        placeholder="Nombre Socio" aria-label="First-name" readonly>
      </div>
    </div>
    <table id="reportesTable" class="table table-striped">
      <thead>
        <tr>
          <th>Consolidados saldos</th>
          <th>Carta Espa√±ol</th>
          <th>Rendimientos Financieros</th>
          <th>Ejecucion Presupuestal</th>
        </tr>
      </thead>
      <tbody id="reportesTablaBody">
        <!----se inserta info tablas -->


      </tbody>
    </table>


    <template id="reportesRow">
      <tr>
        <td class="reporteConsolidado"> </td>
        <td class="reporteCarta"> </td>
        <td class="reporteRendimientos"> </td>
        <td class="reporteEjecucion"> </td>
      </tr>
    </template>
  </div>






  <!-- JavaScript Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous">
  </script>

  <script>
     function buscarRegistro() {

      var nombreSocio = document.getElementById("nombreSocio").value;
      var InfoNumeroSocio = document.getElementById("numeroSocio");
      var InfoNombreSocio = document.getElementById("Socio");


      google.script.run
         .withSuccessHandler(info => {
            let tableBody = document.getElementById("reportesTablaBody");
            tableBody.innerHTML = "";
            console.log(info);
            if (info.length > 0) {
    
               InfoNumeroSocio.value = info[0][0];
               InfoNombreSocio.value = info[0][1];

               info.forEach(item => {
               const template= document.getElementById("reportesRow");
               const templateRow=template.content;
               
               let tr= templateRow.cloneNode(true);
               let colConsolidado=tr.querySelector(".reporteConsolidado");
               let colCarta=tr.querySelector(".reporteCarta");
               let colRendimiento=tr.querySelector(".reporteRendimientos");
               let colEjecucion=tr.querySelector(".reporteEjecucion");

               colConsolidado.textContent= item[0];
               colCarta.textContent= item[1];
               colRendimiento.textContent= item[2];
               colEjecucion.textContent= item[3];

               tableBody.appendChild(tr)
               console.log(item);
               })

            } else {

              alert("No se encontraron reportes")
            }

         })
         .buscarSocios(nombreSocio);
        
   }
     

  </script>
</body>

</html>


------------------------------------------------------------
codigo.gs

function doGet() {
  const html= HtmlService.createTemplateFromFile("index")
  .evaluate();
  return html;
  
}

function buscarSocios(nombreSocio) {
    
     var listSocios= [];
    var sheet = SpreadsheetApp.openById("1DSD8WqwPFPMZxdEMeagFLEfxX2itnMjCGksJC0ZkueM");
    var sheetRespuestas = sheet.getSheetByName("Base Datos");
    var socios = sheetRespuestas.getDataRange().getDisplayValues();
    
    
  
    socios.forEach(item => {
     if(item[1] ===nombreSocio){
       listSocios.push(item);
     }
    })
   //console.log(listSocios);
   return(listSocios);
  }










</div>
    <div class="row d-flex justify-content-evenly mb-3">
      <div class="col-3">
        <select class="form-select" id="campo" name="campo" aria-label="Default select example" required >
            <option selected none>Seleccione contrato:</option>
          </select>
      </div>
      <div class="col-3">
        <select class="form-select" id="tipoReporte" name="tipo_reporte" aria-label="Default select example"
            required>
            <option selected none>Seleccione reporte: </option>
          </select>
      </div>

      <div class="col-3">
        <button type="button" class="btn btn-primary" >Buscar</button>
      </div>


    </div>



/////////////////////////////////////////

 google.script.run
         .withSuccessHandler(
            function (obj) {
               let tabla = document.createElement('table');
               let tablaBody = document.createElement('tbody');

               Array.from(obj).forEach(filaActual =>
               {
                  let fila = document.createElement('tr');
                  filaActual.forEach(celdaActual => 
                  {
                     let celda=document.createElement('td');
                     celda.textContent=celdaActual;
                     fila.appendChild(fila)
                  });
                  tablaBody.appendChild(fila);
               })
               tabla.appendChild(tablaBody);
               tabla.classList.add('table', 'table-striped', 'border', 'border-3')
               document.getElementById('divLinks').appendChild(tabla)


            }


         ).buscarLinks();

   }

//////////////////////////////////////////////////////////////////////////////////function buscarLinks() {
    
    var sheet = SpreadsheetApp.openById("1DSD8WqwPFPMZxdEMeagFLEfxX2itnMjCGksJC0ZkueM");
    var sheetRespuestas = sheet.getSheetByName("Base Datos");
    var links = sheetRespuestas.getDataRange().getDisplayValues();
    var listLinks= [];
    
  
    links.forEach(item => {
      var link = {}
      link['Consolidado']=item[3]
      link['CartaEsp']=item[4]
      link['Rendimiento']=item[5]
      link['Ejecucion']=item[5]
      listLinks.push(link)
      
      
  
    })
    


value={datos.nit} onChange={handleInputChange}

